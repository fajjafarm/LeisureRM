<?php namespace App\Livewire; use Livewire\Component; use App\Models\SubFacility; use Carbon\Carbon; class SidebarMenu extends Component { public $overdue=[]; public function mount(){$this->refreshOverdue();} public function refreshOverdue(){$this->overdue=SubFacility::with("healthChecks")->get()->filter(fn($sf)=>!$sf->healthChecks->count()||Carbon::now()->diffInMinutes($sf->healthChecks->sortByDesc("created_at")->first()->created_at)>$sf->check_interval_minutes)->pluck("id")->toArray();} public function render(){return view("livewire.sidebar-menu");} }
