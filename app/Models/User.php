<?php namespace App\Models; use Illuminate\Database\Eloquent\Factories\HasFactory; use Illuminate\Foundation\Auth\User as Authenticatable; use Illuminate\Notifications\Notifiable; use Laravel\Sanctum\HasApiTokens; use Spatie\Permission\Traits\HasRoles; class User extends Authenticatable { use HasApiTokens, HasFactory, Notifiable, HasRoles; protected $fillable = ["name","email","password","rank"]; protected $hidden = ["password","remember_token"]; protected $casts = ["email_verified_at"=>"datetime","rank"=>"string"]; public function businesses(){return $this->belongsToMany(\App\Models\Business::class);} public function facilities(){return $this->belongsToMany(\App\Models\Facility::class);} public function poolTests(){return $this->hasMany(\App\Models\PoolTest::class);} public function healthChecks(){return $this->hasMany(\App\Models\HealthCheck::class);} public function tasksAssigned(){return $this->hasMany(\App\Models\Task::class,"assigned_by");} public function tasksReceived(){return $this->hasMany(\App\Models\Task::class,"assigned_to_user_id");} public function rankPriority(): int { return match($this->rank){ "Resort Director"=>7,"Recreations Manager"=>6,"Manager"=>5,"Deputy Manager"=>4,"Assistant Manager"=>3,"Supervisor"=>2,"Assistant"=>1,default=>0 }; } }
